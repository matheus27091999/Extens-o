<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <title>Quiz Interativo (Versão Local)</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .page { display: none; }
        .page.active { display: block; }
        .form-link { cursor: pointer; font-weight: 600; color: #22d3ee; }
        .form-link:hover { text-decoration: underline; }
        .option-btn { transition: all 0.2s ease-in-out; }
        .option-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="max-w-2xl w-full">
        <!-- Página 1: Login -->
        <div id="loginPage" class="page active">
            <div class="bg-gray-800 p-8 rounded-xl shadow-2xl space-y-6">
                <div class="text-center">
                    <h1 class="text-3xl font-bold text-cyan-400">Quiz Interativo</h1>
                    <p class="text-gray-400 mt-2">Insira seus dados para começar</p>
                </div>
                <form id="loginForm" class="space-y-4">
                    <div>
                        <label for="loginFullName" class="block text-sm font-medium text-gray-300 mb-1">Nome Completo</label>
                        <input type="text" id="loginFullName" name="fullName" placeholder="Ex: Ana Silva" required class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 focus:outline-none">
                    </div>
                    <div>
                        <label for="loginRegistrationId" class="block text-sm font-medium text-gray-300 mb-1">Matrícula</label>
                        <input type="text" id="loginRegistrationId" name="registrationId" placeholder="Ex: 2024001" required class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 focus:outline-none">
                    </div>
                    <button type="submit" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 rounded-lg transition duration-300 shadow-lg">
                        Entrar no Quiz
                    </button>
                </form>
                <p id="loginError" class="text-red-400 text-center text-sm hidden">Usuário não encontrado. Verifique seus dados.</p>
                <p class="text-center text-sm text-gray-400">
                    Não tem uma conta? <span id="showRegisterBtn" class="form-link">Cadastre-se</span>
                </p>
            </div>
        </div>
        
        <!-- Página de Cadastro -->
        <div id="registerPage" class="page">
            <div class="bg-gray-800 p-8 rounded-xl shadow-2xl space-y-6">
                <div class="text-center">
                    <h1 class="text-3xl font-bold text-cyan-400">Crie sua Conta</h1>
                    <p class="text-gray-400 mt-2">Preencha os campos para se registrar</p>
                </div>
                <form id="registerForm" class="space-y-4">
                    <div>
                        <label for="registerFullName" class="block text-sm font-medium text-gray-300 mb-1">Nome Completo</label>
                        <input type="text" id="registerFullName" name="fullName" placeholder="Seu nome completo" required class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 focus:outline-none">
                    </div>
                    <div>
                        <label for="registerRegistrationId" class="block text-sm font-medium text-gray-300 mb-1">Matrícula</label>
                        <input type="text" id="registerRegistrationId" name="registrationId" placeholder="Crie sua matrícula" required class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 focus:outline-none">
                    </div>
                    <button type="submit" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 rounded-lg transition duration-300 shadow-lg">
                        Cadastrar
                    </button>
                </form>
                <p id="registerError" class="text-red-400 text-center text-sm hidden"></p>
                <p id="registerSuccess" class="text-green-400 text-center text-sm hidden"></p>
                <p class="text-center text-sm text-gray-400">
                    Já tem uma conta? <span id="showLoginBtn" class="form-link">Faça Login</span>
                </p>
            </div>
        </div>

        <!-- Página 2: Questionário -->
        <div id="quizPage" class="page">
            <div class="bg-gray-800 p-8 rounded-xl shadow-2xl">
                <div id="quizHeader" class="mb-6 border-b border-gray-700 pb-4">
                    <p id="questionCounter" class="text-sm text-cyan-400 font-semibold">Pergunta 1 de 10</p>
                    <h2 id="questionText" class="text-2xl font-semibold mt-2">Carregando pergunta...</h2>
                </div>
                <div id="optionsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                </div>
            </div>
        </div>

        <!-- Página 3: Resultados e Ranking -->
        <div id="resultsPage" class="page">
             <div class="bg-gray-800 p-8 rounded-xl shadow-2xl text-center space-y-6">
                <div>
                    <h1 class="text-3xl font-bold text-cyan-400">Resultado Final</h1>
                    <p class="text-gray-400 mt-2">Parabéns por concluir o quiz!</p>
                </div>
                <div class="bg-gray-700 p-6 rounded-lg">
                    <p class="text-lg text-gray-300">Sua pontuação foi:</p>
                    <p id="finalScore" class="text-6xl font-bold text-white my-2">0</p>
                    <p class="text-gray-400">pontos</p>
                </div>
                <div class="text-left">
                    <h2 class="text-2xl font-bold mb-4 text-center">Ranking Geral</h2>
                    <div class="space-y-3 max-h-60 overflow-y-auto pr-2">
                        <div class="grid grid-cols-12 gap-2 text-sm font-semibold text-cyan-400 border-b border-gray-700 pb-2">
                            <div class="col-span-1 text-center">#</div>
                            <div class="col-span-6">Nome</div>
                            <div class="col-span-3">Matrícula</div>
                            <div class="col-span-2 text-right">Pontos</div>
                        </div>
                        <div id="rankingList">
                        </div>
                    </div>
                </div>
                 <button onclick="restartQuiz()" class="w-full mt-6 bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 rounded-lg transition duration-300 shadow-lg">
                    Tentar Novamente
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- BANCO DE DADOS LOCAL (localStorage) ---
        let USERS = JSON.parse(localStorage.getItem('quizUsers')) || [
            { fullName: "Usuário Teste", registrationId: "123" } // Um usuário de exemplo para começar
        ];
        let RANKING = JSON.parse(localStorage.getItem('quizRanking')) || [];

        function saveUsers() {
            localStorage.setItem('quizUsers', JSON.stringify(USERS));
        }

        function saveRanking() {
            localStorage.setItem('quizRanking', JSON.stringify(RANKING));
        }

        const QUESTION_BANK = [
        { question: "Qual limite ideal que o cartão de crédito possua referente a renda do usuário?", options: ["10%", "45%", "50%", "85%", "65%"], answer: "50%" },
                { question: "Qual melhor tipo de cartão?", options: ["O que cede mais limite", "O que possibilita parcelar a fatura com juros proporcional", "O que gera programas de pontuação, cashbacks e parcerias"], answer: "O que gera programas de pontuação, cashbacks e parcerias" },
                { question: "Qual perfil de inadimplentes no Brasil apresenta o maior percentual?", options: ["18 a 25 anos", "26 a 40 anos", "41 a 65 anos", "Acima de 65 anos"], answer: "41 a 65 anos" },
                { question: "Com relação ao gênero, qual perfil de inadimplente tem um percentual maior?", options: ["Feminino", "Masculino"], answer: "Feminino" },
                { question: "Quais as vantagens do cartão de crédito?", options: ["Gastar mais, já que a renda aumenta somando o crédito a remuneração do usuário", "Aumentar o consumismo devido ao crédito aumentar o poder aquisitivo", "Organização financeira, podendo dividir todas as compras em muitas parcelas", "Planejamento financeiro, podendo realizar compras de modo que o valor seja dissolvido ao longo do tempo planejado"], answer: "Planejamento financeiro, podendo realizar compras de modo que o valor seja dissolvido ao longo do tempo planejado" }
        ];
        
        let currentUser = null;
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;

        const pages = document.querySelectorAll('.page');
        const loginForm = document.getElementById('loginForm');
        const loginError = document.getElementById('loginError');
        const registerForm = document.getElementById('registerForm');
        const registerError = document.getElementById('registerError');
        const registerSuccess = document.getElementById('registerSuccess');
        const showRegisterBtn = document.getElementById('showRegisterBtn');
        const showLoginBtn = document.getElementById('showLoginBtn');
        const questionCounter = document.getElementById('questionCounter');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const finalScore = document.getElementById('finalScore');
        const rankingList = document.getElementById('rankingList');

        function showPage(pageId) {
            pages.forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
        }
        
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startQuiz() {
            score = 0;
            currentQuestionIndex = 0;
            currentQuestions = shuffleArray([...QUESTION_BANK]).slice(0, 5); // 5 perguntas por quiz
            displayQuestion();
            showPage('quizPage');
        }

        function displayQuestion() {
            if (currentQuestionIndex >= currentQuestions.length) {
                showResults();
                return;
            }
            const question = currentQuestions[currentQuestionIndex];
            questionCounter.textContent = `Pergunta ${currentQuestionIndex + 1} de ${currentQuestions.length}`;
            questionText.textContent = question.question;
            optionsContainer.innerHTML = '';
            const shuffledOptions = shuffleArray([...question.options]);
            shuffledOptions.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.className = 'option-btn w-full bg-gray-700 text-white p-4 rounded-lg text-left hover:bg-gray-600 transition duration-200';
                button.onclick = () => selectAnswer(option, button);
                optionsContainer.appendChild(button);
            });
        }

        function selectAnswer(selectedOption, buttonElement) {
            const correctAnswer = currentQuestions[currentQuestionIndex].answer;
            const allButtons = optionsContainer.querySelectorAll('button');
            allButtons.forEach(btn => btn.disabled = true);
            
            if (selectedOption === correctAnswer) {
                score++;
                buttonElement.classList.replace('bg-gray-700', 'bg-green-600');
            } else {
                buttonElement.classList.replace('bg-gray-700', 'bg-red-600');
                allButtons.forEach(btn => {
                    if (btn.textContent === correctAnswer) {
                       btn.classList.replace('bg-gray-700', 'bg-green-600');
                    }
                });
            }
            setTimeout(() => {
                currentQuestionIndex++;
                displayQuestion();
            }, 1200);
        }

        function showResults() {
            finalScore.textContent = score;
            updateRanking();
            displayRanking();
            showPage('resultsPage');
        }

        function updateRanking() {
            RANKING.push({
                fullName: currentUser.fullName,
                registrationId: currentUser.registrationId,
                score: score
            });
            saveRanking();
        }

        function displayRanking() {
            rankingList.innerHTML = '';
            const sortedRanking = [...RANKING].sort((a, b) => b.score - a.score);

            sortedRanking.slice(0, 20).forEach((entry, index) => {
                const rankItem = document.createElement('div');
                rankItem.className = 'grid grid-cols-12 gap-2 text-sm p-2 rounded-md transition hover:bg-gray-700/50';
                if(currentUser && entry.registrationId === currentUser.registrationId) {
                    rankItem.classList.add('bg-cyan-900/50');
                }
                rankItem.innerHTML = `
                    <div class="col-span-1 text-center font-semibold">${index + 1}</div>
                    <div class="col-span-6 truncate">${entry.fullName}</div>
                    <div class="col-span-3">${entry.registrationId}</div>
                    <div class="col-span-2 text-right font-bold">${entry.score}</div>
                `;
                rankingList.appendChild(rankItem);
            });
        }
        
        window.restartQuiz = function() {
            currentUser = null;
            loginForm.reset();
            showPage('loginPage');
        }

        showRegisterBtn.addEventListener('click', () => showPage('registerPage'));
        showLoginBtn.addEventListener('click', () => showPage('loginPage'));

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const fullName = document.getElementById('loginFullName').value.trim();
            const registrationId = document.getElementById('loginRegistrationId').value.trim();
            loginError.classList.add('hidden');

            const foundUser = USERS.find(user => 
                user.registrationId === registrationId && 
                user.fullName.toLowerCase() === fullName.toLowerCase()
            );

            if (foundUser) {
                currentUser = foundUser;
                startQuiz();
            } else {
                loginError.classList.remove('hidden');
            }
        });
        
        registerForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const fullName = document.getElementById('registerFullName').value.trim();
            const registrationId = document.getElementById('registerRegistrationId').value.trim();
            registerError.classList.add('hidden');
            registerSuccess.classList.add('hidden');

            if (!fullName || !registrationId) {
                registerError.textContent = "Por favor, preencha todos os campos.";
                registerError.classList.remove('hidden');
                return;
            }
            
            const userExists = USERS.some(user => user.registrationId === registrationId);

            if (userExists) {
                registerError.textContent = "Esta matrícula já está cadastrada.";
                registerError.classList.remove('hidden');
            } else {
                USERS.push({ fullName, registrationId });
                saveUsers();
                
                registerSuccess.textContent = "Cadastro realizado! Redirecionando...";
                registerSuccess.classList.remove('hidden');
                setTimeout(() => {
                    registerSuccess.classList.add('hidden');
                    showPage('loginPage');
                }, 2000);
            }
        });
        
    </script>
</body>
</html>

